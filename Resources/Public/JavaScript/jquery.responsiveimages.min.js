/* ========================================================================
	* This is a adjusted version of LuÃ­s Almeida jQuery Unveil Script
	* http://luis-almeida.github.com/unveil
	* using verge.js methods for accurate viewport width detection
	* https://github.com/ryanve/verge
  * MIT License 2013 Ryan Van Etten
* ======================================================================== */
+function(t){function i(i){return e=this,this.each(function(){var e=t(this),r=e.data("bk2k.responsiveimage"),p="object"==typeof i&&i;r||(o||(o=new n(p&&p.breakpoints?{breakpoints:p.breakpoints}:{})),p&&p.breakpoints&&(p.breakpoints=null),p=t.extend({},e.data(),p),e.data("bk2k.responsiveimage",r=new s(this,p))),"string"==typeof i&&r[i]()})}var e,o,n=function(i){this.width=0,this.height=0,this.options=t.extend({},n.DEFAULTS,i),this.attrib="src",this.update()};n.DEFAULTS={breakpoints:{0:"xsmall",480:"small",768:"medium",992:"large",1200:"bigger"}},n.prototype.viewportW=function(){var t=document.documentElement.clientWidth,i=window.innerWidth;return i>t?i:t},n.prototype.viewportH=function(){var t=document.documentElement.clientHeight,i=window.innerHeight;return i>t?i:t},n.prototype.inviewport=function(t){return!!t&&t.bottom>=0&&t.right>=0&&t.top<=this.height&&t.left<=this.width},n.prototype.update=function(){this.width=this.viewportH(),this.height=this.viewportW();var i=this.attrib,e=this.width;t.each(this.options.breakpoints,function(t,o){e>=t&&(i=o)}),this.attrib=i},t.fn.viewportH=n.prototype.viewportH,t.fn.viewportW=n.prototype.viewportW;var s=function(i,e){this.$element=t(i),this.options=t.extend({},s.DEFAULTS,e),this.attrib="src",this.loaded=!1,this.retina=window.devicePixelRatio&&window.devicePixelRatio>1,this.checkviewport()};s.DEFAULTS={threshold:100,attrib:"src",skip_invisible:!1,preload:!1},s.prototype.checkviewport=function(){this.attrib!==o.attrib&&(this.attrib=o.attrib,this.loaded=!1),this.unveil()},s.prototype.boundingbox=function(){var t={},i=this.$element[0].getBoundingClientRect(),e=+this.options.threshold||0;return t.right=i.right+e,t.left=i.left-e,t.bottom=i.bottom+e,t.top=i.top-e,t},s.prototype.inviewport=function(){var t=this.boundingbox();return o.inviewport(t)},s.prototype.unveil=function(){if(!(this.loaded||!this.options.preload&&this.options.skip_invisible&&this.$element.is(":hidden"))){var i=this.options.preload||this.inviewport();if(i){var e=this.options[(this.retina?"retina-":"")+this.attrib]||this.options[this.attrib]||this.options.src;e&&(this.$element.attr("src",e),this.$element.css("opacity",1),t(window).trigger("loaded.bk2k.responsiveimage"),this.loaded=!0)}}};var r=t.fn.responsiveimages;t.fn.responsiveimage=i,t.fn.responsiveimage.Constructor=s,t.fn.responsiveimage.noConflict=function(){return t.fn.responsiveimage=r,this},t(window).on("load.bk2k.responsiveimage",function(){t("img.lazyload").responsiveimage(),t(window).on("scroll.bk2k.responsiveimage",function(){e.responsiveimage("unveil")}).on("resize.bk2k.responsiveimage",function(){o&&o.update(),e.responsiveimage("checkviewport")})})}(jQuery);
